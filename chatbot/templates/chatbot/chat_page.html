{% extends 'chatbot/base.html' %}

{% block title %}Chat Page{% endblock %}

{% block content %}
<div class="center-container">
<!-- Sidebar: Chat Options -->
<div class="center-left">
    <div class="contacts">
        <i class="fas fa-bars fa-2x"></i>
        <h2>Chat Options</h2>

        <!-- Text Chat Option -->
        <div class="contact" 
            hx-post="{% url 'send_message' %}" 
            hx-vals='{"chat_type": "text"}' 
            hx-trigger="click" 
            hx-swap="none" 
            onclick="highlightSelected(this); toggleUploadLink(false);">
            <div class="name">Text Chat</div><br>
            <div class="message">
                Chat using simple text messages.
            </div>
        </div>

        <!-- PDF Chat Option -->
        <div class="contact pdf-chat" 
            hx-post="{% url 'send_message' %}" 
            hx-vals='{"chat_type": "pdf"}' 
            hx-trigger="click" 
            hx-swap="none" 
            onclick="highlightSelected(this); toggleUploadLink(true);">
            <div class="name">PDF Chat</div><br>
            <div class="message">
                Chat based on  PDF content.
            </div>
            <br>
            <!-- Upload PDF Link -->
            <div class="upload-container">
                <a href="{% url 'handle_pdf_upload' %}" class="upload-link">
                    <i class="fas fa-upload"></i> Upload PDF
                </a>
            </div>
        </div>

        <!-- Website Chat Option -->
        <div class="contact" 
            hx-post="{% url 'send_message' %}" 
            hx-vals='{"chat_type": "website"}' 
            hx-trigger="click" 
            hx-swap="none" 
            onclick="highlightSelected(this); toggleUploadLink(false);">
            <div class="name">Website Chat</div><br>
            <div class="message">
                Chat with content from a website.
            </div>
        </div>

        <!-- Feedback Option -->
        <div class="contact" 
            hx-post="{% url 'send_message' %}" 
            hx-vals='{"chat_type": "feedback"}' 
            hx-trigger="click" 
            hx-swap="none" 
            onclick="highlightSelected(this); toggleUploadLink(false);">
            <div class="name">Feedback</div><br>
            <div class="message">
                Give Feedback About this Chatbot.
            </div>
        </div>
    </div>
</div>

    <!-- Main Chat Section -->
    <div class="center">
        <div class="chat">
            <!-- Header: Bot Information -->
            <div class="contact bar">
                <div class="pic bot"></div>
                <div class="name">Your Assistant</div>
                <div class="time seen" id="current-time"></div>
            </div>

            <!-- Chat Messages -->
            <div class="messages" id="chat">
                <div class="chat-messages" id="chat-messages">
                    {% for message in messages %}
                        {% include "chatbot/message.html" %}
                    {% endfor %}
                </div>

                <!-- Typing Indicator -->
                <div class="message bot typing-indicator">
                    <div class="typing typing-1"></div>
                    <div class="typing typing-2"></div>
                    <div class="typing typing-3"></div>
                </div>
            </div>

            <!-- Input Section -->
            <div class="input-container">
                <form id="chat-form" hx-post="{% url 'send_message' %}" hx-target="#chat-messages" hx-swap="beforeend">
                    {% csrf_token %}
                    <div class="chat-input-wrapper">
                        <textarea 
                            name="message" 
                            placeholder="Type your message..." 
                            class="chat-input" 
                            id="user-input" 
                            required
                            oninput="adjustHeight(this)"
                        ></textarea>
                        <button type="submit" class="icon-send">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </form>
            </div>
            
        </div>
    </div>
</div>
{% endblock %}
